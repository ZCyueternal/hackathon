# ReSocial 科研训练系统 - 四阶段架构设计

## 系统概述

基于用户需求，将原有的社交训练系统重构为四阶段科研训练系统：
- **开题阶段** → **中期反馈** → **修改完善** → **汇报答辩**

## 系统架构

### 1. 页面流程
```
首页（阶段选择） → 主界面（阶段详情）
```

### 2. 主界面布局
```
┌─────────────────────────────────────────────┐
│           目前所处阶段的进度条               │
├─────────────┬───────────────────────────────┤
│  左侧边栏   │           主内容区             │
│             ├─────────────┬─────────────────┤
│  课题选择   │   AI聊天    │   功能面板       │
│             │   界面      │   (有不同按钮分别展示计划和情感)    │
│  Checklists │             │                 │
└─────────────┴─────────────┴─────────────────┘
```

## 数据模型设计

### 阶段数据结构
```json
{
  "stages": [
    {
      "id": 1,
      "name": "开题阶段",
      "description": "确定研究方向和研究问题",
      "icon": "📝",
      "color": "#4CAF50",
      "topics": [...],
      "checklists": [...]
    }
  ]
}
```

### 课题数据结构
```json
{
  "id": 1,
  "name": "提出课题更改",
  "description": "如何向老师提出课题更改",
}
```

### Checklist 数据结构
```json
{
  "id": 1,
  "stage_id": 1,
  "topic_id": 1,
  "items": [
    {
      "id": 1,
      "description": "明确研究问题和目标",
      "completed": false,
      "weight": 0.3
    }
  ]
}
```

### 主内容区左侧chat 数据结构

```json
{
  "model_name": 1,
  "model_url": "",
  "api": 1,
  "界面参数": [
    {
      "需要上传图片": true,
      "需要输出图片": true,
    }
  ]
}
```

### 主内容区右侧功能框 数据结构

```json
{
    "功能序号":1,
    "功能描述":2,
    "展示内容":3,
    //还需要展示chat部分 AI 输出的checklist等等
}

```

## 功能模块设计

### 1. 阶段选择模块
- 显示四个阶段的大框布局
- 每个阶段包含图标、标题、描述
- 点击进入对应阶段的主界面

### 2. 主界面模块
- **顶部进度条**：显示当前阶段完成度
- **左侧边栏**：
  - 课题选择（可折叠）
  - 当前课题的 Checklist（可折叠）
- **主内容区**：
  - 左侧：AI 聊天界面
  - 右侧：功能面板（得分显示、当前清单等）
  - 这部两侧的内容也要使用数据结构

### 3. AI 聊天模块
- 集成 DeepSeek API
- 支持科研相关的对话
- 提供实时反馈和建议

### 4. 进度追踪模块
- 阶段完成度计算
- Checklist 项目跟踪
- 得分统计

## 文件结构规划

```
project/
├── app.py                          # 主应用文件
├── requirements.txt                # 依赖包
├── assets/                         # 资源文件目录
│   ├── stages.json                 # 阶段配置数据
│   ├── topics.json                 # 课题数据
│   ├── checklists.json             # 清单数据
│   ├── ... 其他json数据
│   └── ui_config.json              # 界面文本配置
├── modules/                        # 功能模块
│   ├── stage_selection.py          # 阶段选择模块
│   ├── main_interface.py           # 主界面模块
│   ├── chat_interface.py           # 聊天界面模块
│   ├── progress_tracker.py         # 进度追踪模块
│   └── data_loader.py              # 数据加载模块
└── utils/                          # 工具函数
    ├── api_client.py               # API 客户端
    ├── session_manager.py          # 会话管理
    └── style_utils.py              # 样式工具
```

## 实现优先级

1. ✅ 创建数据结构和配置文件
2. 🔄 重构主应用框架
3. ⏳ 实现阶段选择页面
4. ⏳ 实现主界面布局
5. ⏳ 集成 AI 聊天功能
6. ⏳ 实现进度追踪
7. ⏳ 测试完整流程

## 技术要点

- 所有界面文本从配置文件加载
- 函数模块化，职责分离
- 支持响应式布局
- 状态管理清晰
- 错误处理完善